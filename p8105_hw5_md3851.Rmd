---
title: "p8105_hw5_md3851"
author: "Misbath Daouda"
date: "11/3/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(viridis)
library(broom)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

## Problem 1 

Loading Iris dataset
```{r}
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species)) %>% 
  view()
```

Tidying Iris dataset
```{r}
cleaning = function(x) {
  
   if(is.numeric(x)) {
   replace_na(x, round(mean(x, na.rm = TRUE)))
   }
   else if (is.character(x)) 
     {replace_na(x, "virginica")}
}

output = map_dfr(.x = iris_with_missing, ~ cleaning(.x), .id = "input")
output 
```

## Problem 2

```{r}
names_df = 
  tibble(
  subject = list.files(path="./data")
)

file_path = "./data/"
file_names = file_path %>% 
  list.files()

observations_df = 
  file_names %>%
  map_dfr(function(file_name){
  
  read_csv(paste0(file_path, file_name))
}) 

study_data = cbind(names_df, observations_df) %>%
 mutate(subject = str_replace(subject, ".csv", "")) %>%
 pivot_longer(
    week_1:week_8,
    names_to = "week",
    names_prefix = "week_",
    values_to = "observations") 

study_data %>%
  ggplot(aes(x = week, y = observations, color = subject)) +
  geom_line()


```

## Problem 3 

```{r}
sim_regression = function(n = 30, beta0 = 2, beta1 = 0, sigma_sq = 50) {
  
  sim_data = tibble(
    x = rnorm(n),
    y = beta0 + beta1 * x + rnorm(n, 0, sigma_sq)
  )
  
  ls_fit = lm(y ~ x, data = sim_data)
  
  #tibble(
    #beta0_hat = coef(ls_fit)[1],
    #beta1_hat = coef(ls_fit)[2]
  #)
  
  tidy_fit = tidy(ls_fit)
}

sim_results_0 = 
  rerun(10000, sim_regression()) %>% 
  bind_rows() %>% 
  select(-std.error, -statistic)
```

```{r, eval = FALSE}
sim_results_1 = 
  rerun(10000, sim_regression(beta1 = 1)) %>% 
  bind_rows()

sim_results_2 = 
  rerun(10000, sim_regression(beta1 = 2)) %>% 
  bind_rows()

sim_results_3 = 
  rerun(10000, sim_regression(beta1 = 3)) %>% 
  bind_rows()

sim_results_4 = 
  rerun(10000, sim_regression(beta1 = 4)) %>% 
  bind_rows()

sim_results_5 = 
  rerun(10000, sim_regression(beta1 = 5)) %>% 
  bind_rows()

sim_results_6 = 
  rerun(10000, sim_regression(beta1 = 6)) %>% 
  bind_rows()
```

```{r}
sim_results_1_to_6 = 
    rerun(10000, sim_regression(beta1 = 1:6)) %>% 
  bind_rows()
```




